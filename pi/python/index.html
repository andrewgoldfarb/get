#! /bin/sh
#
# curl -Ls http://cloudmesh.github.io/get/pi/python | sh
#

# <pre>
VERSION='3.8.2'
NORMAL='\033[0m'
RED='\033[0;31m'

start=`date +%s`

AddToBashrc(){
grep -qF -- "${1}" ~/.bashrc || echo "${1}" >> "${HOME}/.bashrc"
}

Echo() {
 echo "${RED}${1}${NORMAL}"
}

Echo "#################################################"
Echo "# Raspbery Pi Python $VERSION Instalation     #"
Echo "#################################################"
echo
echo "This script runs on a PI4 about
echo
echo    * 160 seconds when you run it again
echo
echo  so please be patient.
echo
Echo "# -----------------------------------------------"
Echo "# Update the system"
Echo "# -----------------------------------------------"
sudo apt-get update
sudo apt-get full-upgrade
sudo apt-get install -y build-essential \
    tk-dev\
    libncurses5-dev\
    libncursesw5-dev\
    libreadline6-dev\
    libdb5.3-dev\
    libgdbm-dev\
    libsqlite3-dev\
    libssl-dev\
    libbz2-dev\
    libexpat1-dev\
    liblzma-dev\
    zlib1g-dev\
    libffi-dev

echo
Echo "# -----------------------------------------------"
Echo "# Download the source for Python $VERSION"
Echo "# -----------------------------------------------"
wget https://www.python.org/ftp/python/$VERSION/Python-$VERSION.tar.xz

echo
Echo "# -----------------------------------------------"
Echo "# Compile Python $VERSION"
Echo "# -----------------------------------------------"
tar xf Python-$VERSION.tar.xz
cd Python-$VERSION
./configure --prefix=/usr/local/opt/python-$VERSION
make -j echo
Echo "# -----------------------------------------------"
Echo "# Install Python $VERSION"
Echo "# -----------------------------------------------"
sudo make altinstall
AddToBashrc "export PATH=$PATH:/usr/local/opt/python-$VERSION/bin"

Echo "#################################################"
Echo "# Install for Python $VERSION Completed         #"
Echo "#################################################"
end=`date +%s`
runtime=$((end-start))
echo
echo "Time to install:" ${runtime} s
echo
Echo "#################################################"

exit 0

# </pre>

