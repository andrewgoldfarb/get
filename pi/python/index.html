#! /bin/sh

#
# curl -Ls http://cloudmesh.github.io/get/pi/python | sh
#

# <pre>


start=`date +%s`

if [ -z "${VERSION}" ]; then
    VERSION='3.8.2'
fi

NORMAL='\033[0m'
RED='\033[0;31m'



AddToBashrc(){
grep -qF -- "${1}" ~/.bashrc || echo "${1}" >> "${HOME}/.bashrc"
}

Echo() {
 echo "${RED}${1}${NORMAL}"
}

Echo "#################################################"
Echo "# Raspbery Pi Python ${VERSION} Installation"
Echo "#################################################"
echo
Echo "# -----------------------------------------------"
Echo "# Update the system"
Echo "# -----------------------------------------------"
sudo apt-get update
sudo apt-get full-upgrade
sudo apt-get install -y build-essential \
    tk-dev\
    libncurses5-dev\
    libncursesw5-dev\
    libreadline6-dev\
    libdb5.3-dev\
    libgdbm-dev\
    libsqlite3-dev\
    libssl-dev\
    libbz2-dev\
    libexpat1-dev\
    liblzma-dev\
    zlib1g-dev\
    libffi-dev

echo
Echo "# -----------------------------------------------"
Echo "# Download the source"
Echo "# -----------------------------------------------"
wget https://www.python.org/ftp/python/${VERSION}/Python-${VERSION}.tar.xz

echo
Echo "# -----------------------------------------------"
Echo "# Compile Python"
Echo "# -----------------------------------------------"
tar xf Python-${VERSION}.tar.xz
cd Python-${VERSION}
./configure --prefix=/usr/local/opt/python-${VERSION}
make -j echo
Echo "# -----------------------------------------------"
Echo "# Install Python"
Echo "# -----------------------------------------------"
sudo make altinstall

Echo "#################################################"
Echo "# Install of Python ${VERSION} Completed"
Echo "#################################################"
end=`date +%s`
runtime=$((end-start))
echo
echo "Time to install:  ${runtime} s"
echo
Echo "#################################################"

exit 0

# </pre>

